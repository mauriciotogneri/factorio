<html>

<head>
    <title>Factorio</title>
    <link href='css/style.css' rel='stylesheet' />
    <script src='js/grid.js' type='text/javascript'></script>
    <script src='js/building.js' type='text/javascript'></script>
    <script src='js/map.js' type='text/javascript'></script>
    <script src='js/engine.js' type='text/javascript'></script>
    <script src='js/field.js' type='text/javascript'></script>
    <script src='js/resource.js' type='text/javascript'></script>
    <script>
        let map = null
        let engine = null
        let grid = null
        let lastTimestamp = 0

        function init() {
            map = new Map()
            map.load()
            engine = new Engine(map)

            const canvas = document.getElementById('canvas')
            canvas.width = document.body.clientWidth
            canvas.height = document.body.clientHeight
            grid = new Grid(canvas, map)
            grid.render()

            window.requestAnimationFrame(step)
        }

        function step(timestamp) {
            engine.update(timestamp - lastTimestamp)
            lastTimestamp = timestamp
            window.requestAnimationFrame(step)
        }
    </script>
</head>

<body onload='init()'>
    <canvas id='canvas'></canvas>
    <img id='img.headquarters' src='img/headquarters.png' style='display: none' />
    <img id='img.grass' src='img/grass.png' style='display: none' />
    <img id='img.coal' src='img/coal.png' style='display: none' />
    <img id='img.coal.mine' src='img/coal.mine.png' style='display: none' />
    <img id='img.conveyor' src='img/conveyor.png' style='display: none' />
</body>

</html>