<html>

<head>
    <title>Factorio</title>
    <link href='css/style.css' rel='stylesheet' />
    <script src='js/grid.js' type='text/javascript'></script>
    <script src='js/building.js' type='text/javascript'></script>
    <script src='js/map.js' type='text/javascript'></script>
    <script src='js/engine.js' type='text/javascript'></script>
    <script src='js/field.js' type='text/javascript'></script>
    <script src='js/patch.js' type='text/javascript'></script>
    <script>
        let map = null
        let engine = null
        let grid = null
        let lastTimestamp = 0

        function init()
        {
            map = new Map()
            map.load()
            engine = new Engine(map)

            const canvas = document.getElementById('canvas')
            canvas.width = document.body.clientWidth
            canvas.height = document.body.clientHeight
            grid = new Grid(canvas, map)
            grid.render()

            window.requestAnimationFrame(step)
        }

        function step(timestamp)
        {
            engine.update(timestamp - lastTimestamp)
            lastTimestamp = timestamp
            window.requestAnimationFrame(step)
        }
    </script>
</head>

<body onload='init()'>

    <canvas id='canvas'></canvas>

    <img id='img.building.headquarters' src='img/building/building.headquarters.png' style='display: none' />
    <img id='img.building.mine.coal' src='img/building/building.mine.coal.png' style='display: none' />
    <img id='img.building.mine.copper' src='img/building/building.mine.copper.png' style='display: none' />
    <img id='img.building.mine.iron' src='img/building/building.mine.iron.png' style='display: none' />
    <img id='img.building.mine.stone' src='img/building/building.mine.stone.png' style='display: none' />

    <img id='img.connection.junction' src='img/connection/connection.junction.png' style='display: none' />
    <img id='img.connection.sorter' src='img/connection/connection.sorter.png' style='display: none' />
    <img id='img.connection.router' src='img/connection/connection.router.png' style='display: none' />
    <img id='img.connection.overflow' src='img/connection/connection.overflow.png' style='display: none' />

    <img id='img.conveyor.left' src='img/conveyor/conveyor.left.png' style='display: none' />
    <img id='img.conveyor.right' src='img/conveyor/conveyor.right.png' style='display: none' />
    <img id='img.conveyor.up' src='img/conveyor/conveyor.up.png' style='display: none' />
    <img id='img.conveyor.down' src='img/conveyor/conveyor.down.png' style='display: none' />

    <img id='img.field.grass' src='img/field/field.grass.png' style='display: none' />

    <img id='img.patch.coal' src='img/patch/patch.coal.png' style='display: none' />
    <img id='img.patch.iron' src='img/patch/patch.iron.png' style='display: none' />
    <img id='img.patch.copper' src='img/patch/patch.copper.png' style='display: none' />
    <img id='img.patch.stone' src='img/patch/patch.stone.png' style='display: none' />

    <img id='img.resource.ore.coal' src='img/resource/resource.ore.coal.png' style='display: none' />
    <img id='img.resource.ore.copper' src='img/resource/resource.ore.copper.png' style='display: none' />
    <img id='img.resource.ore.iron' src='img/resource/resource.ore.iron.png' style='display: none' />
    <img id='img.resource.ore.stone' src='img/resource/resource.ore.stone.png' style='display: none' />
    <img id='img.resource.brick' src='img/resource/resource.brick.png' style='display: none' />
    <img id='img.resource.copper' src='img/resource/resource.copper.png' style='display: none' />
    <img id='img.resource.iron' src='img/resource/resource.iron.png' style='display: none' />
    <img id='img.resource.steal' src='img/resource/resource.steal.png' style='display: none' />

</body>

</html>